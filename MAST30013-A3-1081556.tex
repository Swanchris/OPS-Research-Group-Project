\documentclass{article}
\usepackage{color,graphicx,epstopdf}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{lipsum}  
\newcommand{\BM}[1]{\mbox{\boldmath $#1$}}
\newsavebox{\fmbox}
\newenvironment{fmpage}[1]
{\begin{lrbox}{\fmbox}\begin{minipage}{#1}}
		{\end{minipage}\end{lrbox}\fbox{\usebox{\fmbox}}}
	
\pagenumbering{arabic}


\title{Techniques in Operations Research\\ Assignment 1 -- 2021}
\author{Mark O'Brien, 1081556}

\date{\today}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Question 1 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
\maketitle
\section*{Question 1}
% a) %%%%%%%%%%%%%%
\subsection*{a)}\label{ssec:name}
% have picture here
%\begin{figure}[h!]
%\centering
%\includegraphics[width=0.7\textwidth]{script.png}
%\caption{MATLAB script.m code}\label{fig:log}
%\end{figure}


% b) %%%%%%%%%%%%%%
\subsection*{b)}\label{ssec:name}
\begin{align*}
\min\;\;\;\;&f(x)=-x_1-3x_2\\
s.t. \;\;\;\;&g_1(x)=-x_1-x_2+1\leq0\\
&g_2(x)=x_1-2\leq0\\
&h(x)=2x_1-x_2+1=0\\
\end{align*}

% c) %%%%%%%%%%%%%%
\subsection*{c)}\label{ssec:name}
The KKT conditions for the program are:\\
\\
\hspace*{10mm}
KKTa: 
$$0 = \nabla f(x^*)+\nabla g(x^*)\lambda^* + \nabla h(x^*)\eta^*$$
\hspace*{10mm}
KKTb:
\begin{align*}
1)&\;\;g(x^*)\leq0\\
2)&\;\;\lambda^*\geq0\\
3)&\;\;\lambda_i^*g_i(x^*)=0,\;\;\forall i\\
\end{align*}
\hspace*{10mm}
KKTc:
$$h(x^*)=0$$

% d) %%%%%%%%%%%%%%
\subsection*{d)}\label{ssec:name}
$$
L(x^*, \lambda^*, \eta^*) = -x_1-3x_2 + \lambda_1^*(-x_1-x_2+1) + \lambda_2^*(x_1-2) + \eta^*(2x_1-x_2+1)$$
KKTa:
$$\nabla L_x(x^*, \lambda^*, \eta^*) = 
\begin{bmatrix}
-1-\lambda_1^*+\lambda_2^*+2\eta^*\\
-3-\lambda_1^*-\eta^*
\end{bmatrix}
=0
$$
$\Rightarrow$
\begin{align}
-1-\lambda_1^*+\lambda_2^*+2\eta^*&=0\\
-3-\lambda_1^*-\eta^*&=0
\end{align}
\\
KKTc:
$$2x_1^*-x_2^*+1=0$$
\\
Consider:\\
\\
\hspace*{10mm}
%%%%%%%%%%%%%%%%%% Both active
\textbf{Both $g_1$ and $g_2$ active:}\\
\\
\hspace*{20mm}
KKTb:
$$\Rightarrow -x_1^*-x_2^*+1 = 0,\;\;\;\;x_1-2=0$$
$$\Rightarrow x_1^*=2,\;\Rightarrow x_2^*=-1$$
$$x^*=(2,-1)$$
\hspace*{20mm}
Verify $x^*$ with KKTc:
$$h(x^*)=2(2)-(-1)+1=6\neq0$$
\hspace*{20mm}
Therefore $x^*$ infeasible\\
%%%%%%%%%%%%%%%%%% g1 active,
\\
\hspace*{10mm}
\textbf{$g_1$ active, $g_2$ inactive:}\\
\\
\hspace*{20mm}
KKTb:
$$\Rightarrow -x_1^*-x_2^*+1 = 0,\;\;\;\;\lambda_2^*=0$$
$$\Rightarrow x_1^*=-x_2^*+1$$
\\
\hspace*{20mm}
Substitute $x_1^*$ into KKTc:
$$\Rightarrow 2(-x_2^*+1)-x_2^*+1=0,$$
$$\Rightarrow-3x_2^*+3=0$$
$$\Rightarrow x_2^*=1\;\;\Rightarrow x_1^*=0$$
$$x^*=(0,1)$$
\hspace*{20mm}
Verify $x^*$ satisfies KKTb(1):
$$g_2(x^*)=(0)-1\leq0$$

So far $x^*=(2,5)$ is promising, but lack enough information to test for optimality, so further testing required.\\
%%%%%%%%%%%%%%%%%%% g2 active
\\
\hspace*{10mm}
\textbf{$g_2$ active, $g_1$ inactive:}\\
\\
\hspace*{20mm}
KKTb:
$$\Rightarrow x_1^*-2= 0,\;\;\;\;\lambda_1^*=0$$
$$\Rightarrow x_1^*=2$$
\\
\hspace*{20mm}
Substitute $x_1^*$ into KKTc:
$$\Rightarrow 2(-2)-x_2^*+1=0,$$
$$\Rightarrow x_2^*=5$$
$$x^*=(2,5)$$
\hspace*{20mm}
Verify $x^*$ satisfies KKTb(1):
$$g_1(x^*)=-(2)-(5)+1\leq0$$

So far $x^*=(2,5)$ is promising, but lack enough information to test for optimality, so further testing required.\\
%%%%%%%%%%%%%%%%%% none active,
\\
\hspace*{10mm}
\textbf{Both $g_1$ and $g_2$ inactive:}\\
\\
\hspace*{20mm}
KKTb:
$$\Rightarrow \lambda_1^*, \lambda_2^*=0$$
$$\Rightarrow \lambda^* = (0,0)$$
\hspace*{20mm}
Substitute $\lambda^*$ into KKTa:
$$-1+2\eta^*=0$$
$$-3-\eta^*=0$$
\hspace*{20mm}
$\nexists\; \eta^*$ which satisfies KKTa, therefore problem unsolvable

\newpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Question 2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Question 2}
% a) %%%%%%%%%%%%%%
\subsection*{a)}\label{ssec:name}
The KKT conditions for the program are:\\
\\
\hspace*{10mm}
KKTa: 
$$\nabla f(x^*)+\nabla g(x^*)\lambda^* + \nabla h(x^*)\eta^*=0$$
$$\Rightarrow \nabla L_x(x^*,\lambda^*) = 
\begin{bmatrix}
(x_1^*-2)^3+\lambda_1^*-\lambda_2^*\\
4(x_2^*)^3-\lambda_1^*+2x_2^*\lambda_2^*
\end{bmatrix}
=0
$$
\hspace*{10mm}
KKTb:
\begin{align*}
1)&\;\;g(x^*)\leq0\\
2)&\;\;\lambda^*\geq0\\
3)&\;\;\lambda_i^*g_i(x^*)=0,\;\;\forall i\\
\end{align*}
\\
Consider:\\
\\
\hspace*{10mm}
%%%%%%%%%%%%%%%%%% Both active
\textbf{Both $g_1$ and $g_2$ active:}\\
\\
\hspace*{20mm}
KKTb:
$$\Rightarrow x_1^*-x_2^*-8 = 0,\;\;\;\;-x_1+(x_2^*)^2+4=0$$
$$\Rightarrow x_1^*=x_2^*+8\;\;\;\Rightarrow\;\; -x_2^*+(x_2^*)^2-4=0$$
\\
\hspace*{20mm}
No real solutions for $x^*$, therefore infeasible\\
%%%%%%%%%%%%%%%%%% g1 active,
\\
\hspace*{10mm}
\textbf{$g_1$ active, $g_2$ inactive:}\\
\\
\hspace*{20mm}
KKTb:
$$\Rightarrow x_1^*-x_2^*-8 = 0,\;\;\;\;\lambda_2^*=0$$
$$\Rightarrow  x_1^* = x_2^*+8$$
\\
\hspace*{20mm}
Substitute $x_1^*$ into KKTa:
$$\Rightarrow \nabla L_x(x_2^*+8,x_2^*,\lambda_1^*,0) = 
\begin{bmatrix}
(x_2^*+6)^3+\lambda_1^*\\
4(x_2^*)^3-\lambda_1^*
\end{bmatrix}
=0
$$
\\
\hspace*{20mm}
Solving we get:
$$x^*=(5.681, -2.319),\;\;\;\;\lambda^*=(-49.8975,0)$$
\hspace*{20mm}
But $\lambda^*$ violates KKTb. Therefore, infeasible\\
%%%%%%%%%%%%%%%%%%% g2 active
\\
\hspace*{10mm}
\textbf{$g_2$ active, $g_1$ inactive:}\\
\\
\hspace*{20mm}
KKTb:
$$\Rightarrow -x_1^*+(x_2^*)^2+4= 0,\;\;\;\;\lambda_1^*=0$$
$$\Rightarrow x_1^*=(x_2^*)^2+4$$
\\
\hspace*{20mm}
Substitute $x_1^*$ into KKTa:
$$\Rightarrow \nabla L_x((x_2^*)^2+4,x_2^*,0,\lambda_2^*) = 
\begin{bmatrix}
((x_2^*)^2+2)^3-\lambda_2^*\\
4(x_2^*)^3+2x_2^*\lambda_2^*
\end{bmatrix}
=0
$$
\begin{align}
\Rightarrow((x_2^*)^2+2)^3-\lambda_2^*&=0\\
2x_2^*(2(x_2^*)^2+\lambda_2^*)&=0
\end{align}
\\
\hspace*{20mm}
With (4) we get:
$$x_2^*=0,\;\;\;\;\;\;\;x_2^*=\pm\sqrt{\frac{-\lambda_2^*}{2}}$$
\\
\hspace*{20mm}
But since we need $\lambda_2^*\geq0$ (KKTb), we reject second solution:
$$\therefore\;\;\mathbf{x_2^*=0}$$
\\
\hspace*{20mm}
Using (3), solve for $\lambda_2^*$:
$$((0)^2+2)^3-\lambda_2^*=0\;\;\;\;\Rightarrow\mathbf{\lambda_2^*=8}$$
\\
\hspace*{20mm}
Using KKTb, solve for $x_1^*$:
$$x_1^*=(0)^2+4\;\;\;\;\Rightarrow\mathbf{x_1^*=4}$$
$$\therefore\;\;\mathbf{x^*=(4,0)},\;\;\;\;\mathbf{\lambda^*=(0,8)}$$
\hspace*{20mm}
Verify $x^*$ satisfies KKTb(1):
$$g_1(x^*)=(4)-(0)-8=-4\leq0$$
\hspace*{20mm}
Therefore, all KKT conditions have been satisfied.\\
%%%%%%%%%%%%%%%%%% none active,
\\
\hspace*{10mm}
\textbf{Both $g_1$ and $g_2$ inactive:}\\
\\
\hspace*{20mm}
KKTb:
$$\Rightarrow \lambda_1^*, \lambda_2^*=0$$
\hspace*{20mm}
Solve for $x^*$ using KKTa:
$$\Rightarrow \nabla L_x(x_1^*,x_2^*,0,0) = 
\begin{bmatrix}
((x_1^*-2)^3\\
4(x_2^*)^3
\end{bmatrix}
=0
$$
$$\Rightarrow x^*=(0,0)$$
\\
\hspace*{20mm}
Verify $x^*$ satisfies KKTb(1):
$$g_1(x^*)=(0)-(0)-8\leq0$$
$$g_2(x^*)=-(0)+(0)^2+4\nleq0$$
\\
\hspace*{20mm}
$x^*$ violates KKTb, therefore infeasible.

% b) %%%%%%%%%%%%%%
\subsection*{b)}\label{ssec:name}
$$\nabla g_1(x) = 
\begin{bmatrix}
1\\
-1
\end{bmatrix}
\;\;\;\;
\nabla g_2(x)=
\begin{bmatrix}
-1\\
2x_2
\end{bmatrix}
$$\\
$$\Rightarrow \nabla g(x)=
\begin{bmatrix}
1 & -1\\
-1 & 2x_2
\end{bmatrix}
$$
Inspect $x^*=(4,0)$:
$$\nabla g(x^*) = 
\begin{bmatrix}
1 & -1\\
-1 & 0
\end{bmatrix}
$$
To satisfy Mangasarian-Fomovitz condition, need:
$$
\nabla g(x^*)^Td<0$$
$$\Rightarrow
\begin{bmatrix}
1 & -1\\
-1 & 0
\end{bmatrix}
\begin{bmatrix}
d_1\\
d_2
\end{bmatrix}
<0
$$
\begin{align*}
d_1-d_2&<0\;\;\;\;\Rightarrow \mathbf{d_1<d_2}\\
-d_1&<0\;\;\;\;\Rightarrow \mathbf{d_1>0}\\
\end{align*}
Choose d:
$$d=
\begin{bmatrix}
1\\
2
\end{bmatrix}
$$ 
At $x^*=(4,0)$, $\exists\; d$ which satistfies the M-F Condition.

% c) %%%%%%%%%%%%%%
\subsection*{c)}\label{ssec:name}
To check local minimality, need:
$$d^T\nabla^2_{xx}L(x^*,\lambda^*)d>0$$
Find Hessian of Lagrangian:
$$
\nabla L_x=
\begin{bmatrix}
(x_1^*-2)^3+\lambda_1^*-\lambda_2^*\\
4(x_2^*)^3-\lambda_1^*+2x_2^*\lambda_2^*
\end{bmatrix}
\;\;\;\;
\nabla^2L_{xx}=
\begin{bmatrix}
3(x_1-2)^2 & 0\\
0 & 12x_2^2
\end{bmatrix}
$$
\\
Check sufficient optimality condition at $x^*=(4,0)$:
\begin{align*}
d^T\nabla^2_{xx}L(x^*,\lambda^*)d&=
\begin{bmatrix}
1 & 2
\end{bmatrix}
\begin{bmatrix}
12 & 0\\
0 & 0
\end{bmatrix}
\begin{bmatrix}
1\\
2
\end{bmatrix}
\\
&=12>0
\end{align*}
Therefore, sufficient optimality condition is satisfied.\\
Therefore, $(4,0)$ is a local minimum.

\end{document} 